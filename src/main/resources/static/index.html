<!DOCTYPE html>
<html>
<head>
  <title>Office Document Processor</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
    .page { width: clamp(320px, 90vw, 880px); margin-inline: auto; }

    .method { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
    label { font-weight: 600; display: block; margin: 8px 0 4px; }
    input[type="file"] { margin: 10px 0; }
    select, textarea { width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; }
    textarea { resize: vertical; min-height: 96px; }
    button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; }
    button:hover { background: #0056b3; }
    small.hint { color: #666; display: block; margin-top: 4px; }

    .row { display: grid; gap: 12px; grid-template-columns: 1fr; }
    @media (min-width: 720px) { .row { grid-template-columns: 1fr 1fr; } }

    .hidden { display: none; }
    .inline { display: inline-flex; align-items: center; gap: 8px; }
  </style>
</head>
<body>
  <div class="page">
    <h1>ğŸ“„ Office Document Processor</h1>

    <div class="method">
      <h2>ğŸ“ æ–‡æ¡£ç¿»è¯‘</h2>
      <p>æ”¯æŒ .doc, .docx, .xls, .xlsx, .ppt, .pptx â€” è½»é‡çº§è§£å†³æ–¹æ¡ˆ</p>

      <form id="form" action="/api/process" method="post" enctype="multipart/form-data">
        <!-- è¯­è¨€é€‰æ‹© -->
        <div class="row">
          <div>
            <label for="sourceLang">åŸæ–‡è¯­è¨€</label>
            <select id="sourceLang" name="sourceLang" aria-describedby="srcHint">
              <option value="auto" selected>è‡ªåŠ¨è¯†åˆ«</option>
              <option value="zh-CN">ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰</option>
              <option value="zh-TW">ä¸­æ–‡ï¼ˆç¹é«”ï¼‰</option>
              <option value="en">Englishï¼ˆè‹±æ–‡ï¼‰</option>
              <option value="ja">æ—¥æœ¬èªï¼ˆæ—¥æ–‡ï¼‰</option>
              <option value="ko">í•œêµ­ì–´ï¼ˆéŸ©æ–‡ï¼‰</option>
              <option value="de">Deutschï¼ˆå¾·æ–‡ï¼‰</option>
              <option value="fr">FranÃ§aisï¼ˆæ³•æ–‡ï¼‰</option>
              <option value="es">EspaÃ±olï¼ˆè¥¿ç­ç‰™æ–‡ï¼‰</option>
              <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹ï¼ˆä¿„æ–‡ï¼‰</option>
              <option value="pt">PortuguÃªsï¼ˆè‘¡è„ç‰™æ–‡ï¼‰</option>
              <option value="it">Italianoï¼ˆæ„å¤§åˆ©æ–‡ï¼‰</option>
              <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©ï¼ˆé˜¿æ‹‰ä¼¯æ–‡ï¼‰</option>
              <option value="vi">Tiáº¿ng Viá»‡tï¼ˆè¶Šå—æ–‡ï¼‰</option>
              <option value="th">à¹„à¸—à¸¢ï¼ˆæ³°æ–‡ï¼‰</option>
              <option value="id">Bahasa Indonesiaï¼ˆå°å°¼æ–‡ï¼‰</option>
              <option value="tr">TÃ¼rkÃ§eï¼ˆåœŸè€³å…¶æ–‡ï¼‰</option>
              <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€ï¼ˆå°åœ°æ–‡ï¼‰</option>
            </select>
          </div>

          <div>
            <label for="targetLang">ç›®æ ‡è¯­è¨€</label>
            <select id="targetLang" name="targetLang" required aria-describedby="tgtHint">
              <option value="en" selected>Englishï¼ˆè‹±æ–‡ï¼‰</option>
              <option value="zh-CN">ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰</option>
              <option value="zh-TW">ä¸­æ–‡ï¼ˆç¹é«”ï¼‰</option>
              <option value="ja">æ—¥æœ¬èªï¼ˆæ—¥æ–‡ï¼‰</option>
              <option value="ko">í•œêµ­ì–´ï¼ˆéŸ©æ–‡ï¼‰</option>
              <option value="de">Deutschï¼ˆå¾·æ–‡ï¼‰</option>
              <option value="fr">FranÃ§aisï¼ˆæ³•æ–‡ï¼‰</option>
              <option value="es">EspaÃ±olï¼ˆè¥¿ç­ç‰™æ–‡ï¼‰</option>
              <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹ï¼ˆä¿„æ–‡ï¼‰</option>
              <option value="pt">PortuguÃªsï¼ˆè‘¡è„ç‰™æ–‡ï¼‰</option>
              <option value="it">Italianoï¼ˆæ„å¤§åˆ©æ–‡ï¼‰</option>
              <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©ï¼ˆé˜¿æ‹‰ä¼¯æ–‡ï¼‰</option>
              <option value="vi">Tiáº¿ng Viá»‡tï¼ˆè¶Šå—æ–‡ï¼‰</option>
              <option value="th">à¹„à¸—à¸¢ï¼ˆæ³°æ–‡ï¼‰</option>
              <option value="id">Bahasa Indonesiaï¼ˆå°å°¼æ–‡ï¼‰</option>
              <option value="tr">TÃ¼rkÃ§eï¼ˆåœŸè€³å…¶æ–‡ï¼‰</option>
              <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€ï¼ˆå°åœ°æ–‡ï¼‰</option>
            </select>
          </div>
        </div>

        <!-- æ˜¯å¦ä½¿ç”¨è‡ªå®šä¹‰æç¤ºè¯ -->
        <label class="inline" for="usePrompt">
          <input type="checkbox" id="usePrompt" />
          ä½¿ç”¨è‡ªå®šä¹‰æç¤ºè¯
        </label>

        <!-- è‡ªå®šä¹‰æç¤ºè¯å®¹å™¨ï¼šé»˜è®¤éšè—ï¼Œå‹¾é€‰åæ˜¾ç¤º -->
        <div id="promptWrap" class="hidden">
          <label for="userPrompt">è‡ªå®šä¹‰æç¤ºè¯</label>
          <textarea
            id="userPrompt"
            name="userPrompt"
            placeholder="ä¾‹ï¼šè¿™ç¯‡æ–‡ç« ä¸æ³•åŠ¡æ¡æ¬¾ç›¸å…³ï¼Œç¿»è¯‘æ—¶è¯·å°½é‡ä½¿ç”¨ä¸“ä¸šæ³•å¾‹æœ¯è¯­ï¼›è¾“å‡ºæ’ç‰ˆä¸åŸæ–‡ä¿æŒä¸€è‡´ã€‚"
            disabled
          ></textarea>
        </div>

        <!-- æ–‡ä»¶ -->
        <label for="file">é€‰æ‹©æ–‡ä»¶</label>
        <input id="file" type="file" name="file" accept=".doc,.docx,.xls,.xlsx,.ppt,.pptx" required>

        <button type="submit">ä½¿ç”¨ POI å¤„ç†</button>
      </form>
    </div>
  </div>

  <script>
    // è¯­è¨€é€‰æ‹©æŒä¹…åŒ–
    const srcSel = document.getElementById('sourceLang');
    const tgtSel = document.getElementById('targetLang');
    srcSel.value = localStorage.getItem('sourceLang') || srcSel.value;
    tgtSel.value = localStorage.getItem('targetLang') || tgtSel.value;
    srcSel.addEventListener('change', () => localStorage.setItem('sourceLang', srcSel.value));
    tgtSel.addEventListener('change', () => localStorage.setItem('targetLang', tgtSel.value));

    // è‡ªå®šä¹‰æç¤ºè¯å¼€å…³é€»è¾‘
    const usePrompt = document.getElementById('usePrompt');
    const promptWrap = document.getElementById('promptWrap');
    const userPrompt = document.getElementById('userPrompt');

    function syncPromptUI() {
      const on = usePrompt.checked;
      promptWrap.classList.toggle('hidden', !on);
      userPrompt.disabled = !on;
      if (!on) userPrompt.value = ''; // å…³é—­æ—¶æ¸…ç©ºï¼Œé¿å…è¯¯æäº¤å†å²å†…å®¹
      localStorage.setItem('usePrompt', String(on));
    }

    // è®°ä½ä¸Šæ¬¡æ˜¯å¦ä½¿ç”¨æç¤ºè¯
    usePrompt.checked = localStorage.getItem('usePrompt') === 'true';
    syncPromptUI();
    usePrompt.addEventListener('change', syncPromptUI);

    // â€œéç©ºâ€æ ¡éªŒ
    document.getElementById('form').addEventListener('submit', (e) => {
      if (usePrompt.checked) {
        const text = userPrompt.value.trim();
        if (text.length === 0) {
          e.preventDefault();
          alert('å·²å‹¾é€‰â€œä½¿ç”¨è‡ªå®šä¹‰æç¤ºè¯â€ï¼Œä½†å†…å®¹ä¸ºç©ºï¼Œè¯·å¡«å†™æˆ–å–æ¶ˆå‹¾é€‰ã€‚');
        }
      }
    });
  </script>
</body>
</html>
